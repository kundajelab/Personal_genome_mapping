Sofia's alignment code, adapted by Oana Ursu for use on scg3.
Preparing now for Github.